<!DOCTYPE>
<html>

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add Product</title>
    <link href="../css/add-product.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.6.0/css/bootstrap.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.6.0/js/bootstrap.min.js"></script>

</head>

<body>
<div class="container">
    <h2 class="h2 mb-5 mt-4">Drugs</h2>
    <!-- Filters -->
    <form id="filterForm">
        <div class="form-row mb-4">

            <!-- Product list -->
            <div class="col-md-3">
                <select id="product-list" class="form-control">
                </select>
            </div>

            <!-- Threshold -->
            <div class="col-md-3">
                <input id="threshold" class="form-control" placeholder="Threshold">
            </div>


            <!-- Amount -->
            <div class="col-md-3">
                <input id="amount" class="form-control" placeholder="Amount">
            </div>


            <!-- Amount -->
            <div class="col-md-2">
                <input id="discount" class="form-control" placeholder="Discount">
            </div>


            <!-- Filter Button -->
            <div class="col-auto">
                <button id="add-product-storage" class="btn btn-custom" type="submit">Add</button>
            </div>
        </div>
    </form>

    <div id='tbl' class="border rounded-xl bg-white">
        <!-- Dynamically generate table using drug data -->
    </div>
    <div class="d-flex flex-wrap">
        <button class="btn-custom-secondary outline-0 border-0 rounded p-2 my-1 col-md-2 col-12" id="cancel-btn">Cancel</button>
        <button type="submit" class="btn btn-custom ml-auto p-2 my-1 col-md-2 col-12" id="add-btn">Add</button>
    </div>
</div>
<script src="../js/addToStorage.js" type="module"></script>
<script type="module">
    import {onInitial} from "../js/addToStorage.js";
    import {createGenericTable} from "../js/table/table.js";

    onInitial();

    function redirectToPage() {
        const url = `index.html?`;
        $("#main-content").load(url, function (response, status, xhr) {
            if (status == "success") {
                console.log("Content loaded successfully");
            } else {
                console.log("Error loading content: " + xhr.status + " " + xhr.statusText);
            }
        });
        $(document).ready(function () {
            $("#sidebar-html").load("sidebar.html");
        });
    }


    document.getElementById("add-product-storage").addEventListener("click", function () {
        event.preventDefault()

        let selectValue = $("#product-list option:selected").text();
        console.log("name: ", selectValue)
        // alert(selectValue)
        let amountValue = document.getElementById("amount").value;
        console.log("amount: ", amountValue)
        // alert(amountValue)
        let thresholdValue = document.getElementById("threshold").value;
        console.log("threshold: ", thresholdValue)
        let discountValue = document.getElementById("discount").value;
        console.log("discount: ", thresholdValue)

        // alert(thresholdValue)

        const receiptData = [];
        console.log("2222")
        const dataOfTheTable = receiptData.push({
            Name: selectValue,
            amount: amountValue,
            threshold: thresholdValue,
            discount: discountValue
        })
        console.log(dataOfTheTable)

        const elem = document.getElementById('storage-list');
        const newRow = document.querySelector('tr')
        if(newRow) {
            
        }

        // Re-render the table with the new data
        createGenericTable(
            "storage-list",
            ["Name", "threshold", "amount","discount"],
            receiptData,
            null,
            "default"
        );
    });

</script>
</body>
</html>

